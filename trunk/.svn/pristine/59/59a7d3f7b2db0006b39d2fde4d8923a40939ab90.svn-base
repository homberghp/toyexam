\newcount\QA@counter
\QA@counter=20
\@whilenum\QA@counter>0\do{%
  \expandafter\newtoks\csname qa@q\romannumeral\QA@counter\endcsname%
  \expandafter\newtoks\csname qa@a\romannumeral\QA@counter\endcsname%
  \expandafter\newtoks\csname qa@r\romannumeral\QA@counter\endcsname%
  \advance\QA@counter\m@ne%
}

\newcommand{\shuffletokpairs}[3]{%[\@ne]{%
  \AMC@sti=#1\relax%
  \AMC@stil=#1\relax%
  \advance\AMC@stil\@ne%
%  \advance\AMC@stil -#1\relax%
  \@whilenum\AMC@sti>0\do{%
    \AMC@SRmax{\AMC@stil}\advance\AMC@SRnum 1\relax%
    \typeout{\the\csname #2\romannumeral\AMC@SRnum\endcsname, %
    \the\csname #3\romannumeral\AMC@SRnum\endcsname\ swap %
    \the\csname #2\romannumeral\AMC@sti\endcsname, %
    \the\csname #3\romannumeral\AMC@sti\endcsname}%
    \AMCsw@p{\csname #2\romannumeral\AMC@SRnum\endcsname}%
            {\csname #2\romannumeral\AMC@sti\endcsname}%
    \AMCsw@p{\csname #3\romannumeral\AMC@SRnum\endcsname}%
            {\csname #3\romannumeral\AMC@sti\endcsname}%
    \advance\AMC@sti\m@ne\relax%
    \advance\AMC@stil\m@ne\relax%
  }}

\newcount\AMCQApair@nswer@counter
\newcommand\QArow[2]{
  \AMC@sti=#1\relax%
  \AMC@stil=#2\relax%
  \AMCQApair@nswer@counter=1\relax%
  \@whilenum\AMCQApair@nswer@counter<\AMC@sti\do{%
    wrong\ %
    \advance\AMCQApair@nswer@counter\@ne%
  }
  correct \ %
  \advance\AMCQApair@nswer@counter\@ne%
  \@whilenum\AMCQApair@nswer@counter<\AMC@stil\do{%
    wrong\ %
    \advance\AMCQApair@nswer@counter\@ne%
  }
}
\newcommand\qapair[2]{%
  \advance\QA@counter\@ne\relax%
  \csname qa@q\romannumeral\QA@counter\endcsname={#1}%
  \csname qa@a\romannumeral\QA@counter\endcsname={#2}%
  \csname qa@r\romannumeral\QA@counter\endcsname={row(\the\QA@counter)}%\QArow{\the\QA@counter}{8}}%
  \typeout{\csname qa@q\romannumeral\QA@counter\endcsname \& %
    \the\csname qa@q\romannumeral\QA@counter\endcsname,%
    \csname qa@a\romannumeral\QA@counter\endcsname \& %
    \the\csname qa@a\romannumeral\QA@counter\endcsname}%
}

\newcommand{\dumpQApair}{%
    \@whilenum\QA@counter>0\do{%
    \typeout{\csname qa@q@\romannumeral\QA@counter\endcsname and %
      \csname qa@a@\romannumeral\QA@counter\endcsname}%
   \the\csname qa@q\romannumeral\QA@counter\endcsname, %
   \the\csname qa@a\romannumeral\QA@counter\endcsname\newline %
    \advance\QA@counter\m@ne}
}

\newcommand{\dumpQRpair}{%
  \advance\QA@counter 8\relax%
    \@whilenum\QA@counter>0\do{%
    \typeout{\csname qa@q@\romannumeral\QA@counter\endcsname and %
      \csname qa@r@\romannumeral\QA@counter\endcsname}%
   \the\csname qa@q\romannumeral\QA@counter\endcsname, %
   \the\csname qa@r\romannumeral\QA@counter\endcsname \newline%
    \advance\QA@counter\m@ne}
}

\newenvironment{qamatrix}{
}{\shuffletokpairs{8}{qa@a}{qa@r}%
\shuffletokpairs{8}{qa@q}{qa@r}%
\dumpQApair%
\par
\dumpQRpair}
